webpackJsonp([64],{37:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,_["default"])(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(u["default"]?(0,u["default"])(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var d=a(2),l=n(d),s=a(5),u=n(s),c=a(3),_=n(c),f=a(4),p=n(f),g=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,l["default"])(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),h=a(1),m=n(h),b=a(41),x=n(b),v=function(e){function t(){return o(this,t),r(this,(t.__proto__||(0,p["default"])(t)).apply(this,arguments))}return i(t,e),g(t,[{key:"render",value:function(){var e=this.props.id;return m["default"].createElement("div",{className:x["default"].box+" "+this.props.className,id:e},this.props.children)}}]),t}(m["default"].Component);t["default"]=v},40:function(e,t,a){t=e.exports=a(6)(),t.push([e.id,".box___2KEmr{position:absolute;top:45px;right:0;bottom:0;left:0;height:auto;overflow-y:scroll;margin-top:-1px;padding:0;margin-bottom:-1px;width:auto;-webkit-overflow-scrolling:touch}.box___2KEmr::-webkit-scrollbar{display:none}",""]),t.locals={box:"box___2KEmr"}},41:[2366,40],349:function(e,t,a){e.exports=a.p+"static/media/gg_nochance.d6d80ba7.png"},517:function(e,t,a){t=e.exports=a(6)(),t.push([e.id,".bg___1Av9T{padding-top:44px;position:absolute;left:0;top:0;width:100%;height:100vh;overflow:auto}.show___SO9pJ{display:block!important}.hide___53fYb{display:none!important}.card_bg___FWT12{position:absolute;width:100%;height:100%;top:0;z-index:2}.nullCard___1wyVz{display:none;width:284px;height:142px;position:absolute;left:3px;top:2px;background:url("+a(349)+") no-repeat;background-size:100% 100%}.nullCard___1wyVz img{display:block;width:45px;margin:20px auto}.nullCard___1wyVz>.noChoose___2Ibvh{font-size:25px;color:#775d54;text-align:center;padding-top:0}.nullCard___1wyVz p{font-size:13px;color:#775d54;text-align:center;padding-top:8px}.box___1LRV5{left:0;height:100%}.box___1LRV5,.card_bg_img___1hptA{position:absolute;top:0;width:100%}.card_bg_img___1hptA{z-index:0}.card___2euVH{position:absolute;top:340px;width:290px;margin-left:-145px;height:148px;left:50%;background:url("+a(579)+") 100% 100% no-repeat;background-size:290px 148px}.have_card___2ehf2,.no_card___1k7bx{width:284px;margin-top:3px;margin-left:3px;height:142px;position:relative;z-index:10}.no_card___1k7bx{display:none;background:url("+a(349)+") 100% 100% no-repeat;background-size:284px 142px}.no_card___1k7bx img{width:45px;padding-top:20px;margin-left:118px}.no_card___1k7bx h2{font-size:25px;color:#775d54;text-align:center;font-weight:500;font-family:-apple-system,Helvetica Neue,Roboto,Segoe UI,sans-serif;line-height:1.2}.no_card___1k7bx p{font-size:13px;color:#775d54;text-align:center;padding-top:8px}.answer___1rXsJ{position:absolute;width:100%;height:100%;z-index:2;top:0;left:0;text-align:center}.answer___1rXsJ h2{font-size:23px;color:#fe6767;text-align:center;padding-top:40px}.answer___1rXsJ button.no_next___1rasJ{display:none;background:#a7a4a5;position:absolute;left:50%;margin-left:-80px;top:70px}.answer___1rXsJ button.next___2WtDZ{display:none;background:#fe6767;position:absolute;left:50%;margin-left:-54px;top:70px}.answer___1rXsJ button{border:none;display:inline-block;padding:10px 20px;border-radius:4px;color:#fff;font-size:17px;margin-top:14px}.gg_b___1OGa7{margin-top:500px;padding:0 15px;width:100%}.gg_b___1OGa7 .gg_line___jkZsO{border:2px dotted #d7d5d5}.gg_info___1PbbN{margin-top:15px}.gg_info___1PbbN span{font-size:13px;color:#fff}.gg_info___1PbbN span:last-child{float:right}.cardResult___2uHYS{position:absolute;width:100%;height:100%;z-index:1}.cardResText___31TvF{position:absolute;left:50%;top:50%;font-size:23px;color:#fe6767;text-align:center;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.guaBox___p9yx3{position:absolute;left:0;top:0;z-index:99}@media screen and (min-device-width:414px) and (-webkit-device-pixel-ratio:3){.card___2euVH{top:420px}.gg_b___1OGa7{margin-top:585px}}.rightNode___1GxWA{font-size:14px;color:#fff}",""]),t.locals={bg:"bg___1Av9T",show:"show___SO9pJ",hide:"hide___53fYb",card_bg:"card_bg___FWT12",nullCard:"nullCard___1wyVz",noChoose:"noChoose___2Ibvh",box:"box___1LRV5",card_bg_img:"card_bg_img___1hptA",card:"card___2euVH",have_card:"have_card___2ehf2",no_card:"no_card___1k7bx",answer:"answer___1rXsJ",no_next:"no_next___1rasJ",next:"next___2WtDZ",gg_b:"gg_b___1OGa7",gg_line:"gg_line___jkZsO",gg_info:"gg_info___1PbbN",cardResult:"cardResult___2uHYS",cardResText:"cardResText___31TvF",guaBox:"guaBox___p9yx3",rightNode:"rightNode___1GxWA"}},579:function(e,t,a){e.exports=a.p+"static/media/guaguamap.b11a9a9d.png"},662:function(e,t,a){var n=a(517);"string"==typeof n&&(n=[[e.id,n,""]]);a(7)(n,{});n.locals&&(e.exports=n.locals)},1196:function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,f["default"])(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(c["default"]?(0,c["default"])(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(2),s=o(l),u=a(5),c=o(u),_=a(3),f=o(_),p=a(4),g=o(p),h=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s["default"])(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),m=a(1),b=o(m),x=a(12),v=o(x),w=a(37),y=o(w),C=a(1795),E=o(C),N=a(662),k=o(N),R=a(8),S=o(R),T=a(1920),z=o(T),A=a(1864),I=o(A),O=a(10),L=a(32),B=n(L),D=a(21),J=a(11),P=a(1801),V=o(P),H=void 0,j=function(e){function t(e){r(this,t);var a=i(this,(t.__proto__||(0,g["default"])(t)).call(this,e));return a.componentWillMount=function(){a.props.detail()},a.componentDidUpdate=function(){H=new Image,H.src=I["default"],H.onload=function(){a.state.showCanvas&&a.initCard()}},a.pdCardRes=function(e){if(e){var t=e.data;if(100==e.code){var n=t.name,o=t.amount;a.setState({cardResName:n,cardResAmount:o,fetch:!1}),a.setState({gua:!0})}else a.setState({cardResName:"获取刮刮卡失败",fetch:!1}),a.setState({gua:!0})}},a.initCard=function(){var e=document.body.style;e.mozUserSelect="none",e.webkitUserSelect="none";var t=300,n=152,o=!1,r=document.getElementById("guaCanvas"),i=document.getElementById("box");if(!r)return!1;var d=document.getElementById("card"),l=d.offsetLeft,s=d.offsetTop,u=r.getContext("2d"),c=function(){for(var e=a.state.fetch,o=u.getImageData(0,0,t,n).data,r=0,i=0;r<o.length;r+=4)o[r]&&o[r+1]&&o[r+2]&&o[r+3]&&i++;if(i<=t*n*.6&&!e){var d=a.props.cardInfo.newCards.length;return a.props.useCard(a.props.cardInfo.newCards[a.state.index].id),a.setState({fetch:!0}),a.setState({showCanvas:!1,index:a.state.index+1}),d<=parseInt(a.state.index+1)?a.setState({guaBtn:!0}):u.clearRect(0,0,t,n),!0}return!1},_=void 0,f=function(e){e.preventDefault(),_=i.scrollTop,o=!0},p=function(e){setTimeout(c,800),e.preventDefault(),o=!1},g=function(e){if(e.preventDefault(),o){e.changedTouches&&(e=e.changedTouches[e.changedTouches.length-1]);var t=(e.clientX+document.body.scrollLeft||e.pageX)-l||0,a=(e.clientY+_||e.pageY)-s||0;u.globalCompositeOperation="destination-out",u.beginPath(),u.arc(t,a,15,0,2*Math.PI),u.fill()}};u.drawImage(H,0,0,t,n),r.addEventListener("touchstart",f),r.addEventListener("touchend",p),r.addEventListener("touchmove",g),r.addEventListener("mousedown",f),r.addEventListener("mouseup",p),r.addEventListener("mousemove",g)},a.useNext=function(){a.setState({showCanvas:!0,fetch:!1,cardResName:"",cardResAmount:""})},a.state={showCanvas:!0,index:0,fetch:!1,cardResName:"",cardResAmount:"",guaBtn:!1},a}return d(t,e),h(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.state.fetch,a=e.userCard;t&&this.pdCardRes(a)}},{key:"render",value:function(){var e=this.state,t=e.cardResName,a=e.cardResAmount,n=e.guaBtn,o=e.index,r=(e.over,this.props.cardInfo),i=r.newCards.length;return 0!=o&&(i=r.newCards.length-o),b["default"].createElement("div",{className:k["default"].bg},b["default"].createElement(v["default"],{backgroundColor:"transparent",leftNode:b["default"].createElement("img",{src:E["default"],height:"20",width:"10",alt:""}),rightNode:b["default"].createElement(D.Link,{className:k["default"].rightNode,to:"/user/scratchesRule"},"规则"),onLeft:this.props.pop},"我的刮刮卡"),b["default"].createElement(y["default"],{className:k["default"].box,id:"box"},b["default"].createElement("img",{className:k["default"].card_bg_img,src:z["default"],alt:""}),b["default"].createElement("div",{className:k["default"].card_bg},b["default"].createElement("div",{id:"card",className:k["default"].card},r.newCards.length>0&&this.state.showCanvas&&b["default"].createElement("div",{id:"have_card",className:k["default"].have_card},b["default"].createElement("canvas",{id:"guaCanvas",style:{width:283,height:142},className:k["default"].guaBox})),b["default"].createElement("div",{className:k["default"].answer},b["default"].createElement("h2",null,t,a),b["default"].createElement("div",{className:(0,S["default"])(r.newCards.length<=0?k["default"].show:"",k["default"].nullCard)},b["default"].createElement("img",{src:V["default"]}),b["default"].createElement("h2",{className:k["default"].noChoose},"没有刮奖机会"),b["default"].createElement("p",null,"每周五出借即可参与刮奖!")),b["default"].createElement("button",{onClick:this.useNext,className:(0,S["default"])(r.newCards.length>0?k["default"].show:"",k["default"].next),disabled:n},"刮下一张"))),b["default"].createElement("div",{className:k["default"].gg_b},b["default"].createElement("p",{className:k["default"].gg_line}),b["default"].createElement("p",{className:k["default"].gg_info},b["default"].createElement("span",null,"您有",i,"次刮奖机会"),b["default"].createElement(D.Link,{to:"/user/guaguaList"},b["default"].createElement("span",null,"您已获得",r.rewardsTime,"次奖励>")))))))}}]),t}(b["default"].Component),M=function(e){return e&&100===e.code?{newCards:e.data.luck_rewards||[],rewardsTime:e.data.rewards}:{newCards:[],rewardsTime:0}},W=function(e){return{cardInfo:M(e.infodata.getIn([B.SCRATCHES_CARD_INFO,"data"])),userCard:e.infodata.getIn([B.SCRATCHES_CARD_USE,"data"])}},X=function(e){return{detail:function(){e({type:B.SCRATCHES_CARD_INFO})},useCard:function(t){e({type:B.SCRATCHES_CARD_USE,params:[t]})},pop:function(){e((0,J.goBack)())}}};t["default"]=(0,O.connect)(W,X)(j)},1279:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1196),r=n(o);t["default"]=r["default"]},1795:function(e,t,a){e.exports=a.p+"static/media/arrowtab.4dde4c61.png"},1801:function(e,t,a){e.exports=a.p+"static/media/cry.cc155451.png"},1864:function(e,t,a){e.exports=a.p+"static/media/gua.20c170b2.png"},1920:function(e,t,a){e.exports=a.p+"static/media/scratchebg.3f8da319.jpg"}});