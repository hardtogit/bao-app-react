webpackJsonp([191],{1089:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,f["default"])(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(c["default"]?(0,c["default"])(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(2),s=n(i),u=a(5),c=n(u),d=a(3),f=n(d),p=a(58),_=n(p),m=a(4),b=n(m),h=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s["default"])(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),x=a(1),g=n(x),E=a(12),v=n(E),k=a(83),y=n(k),I=a(69),w=n(I),S=a(26),T=n(S),N=a(79),R=n(N),U=a(2206),O=n(U),C=a(10),D=a(11),A=a(270),W=n(A),M=a(32),V=a(22),G=n(V),H=function(e){function t(){var e,a,n,l;o(this,t);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return a=n=r(this,(e=t.__proto__||(0,b["default"])(t)).call.apply(e,[this].concat(s))),n.state={name:"",id:"",valid:!1,idValidator:new W["default"],init:!0},n.submit=function(){n.state.valid&&n.refs.confirm.show({title:"身份确认",content:g["default"].createElement("div",{className:O["default"].ensure},g["default"].createElement("p",null,"身份认证后不可修改，请确认信息无误"),g["default"].createElement("p",null,"身份证姓名：",n.state.name),g["default"].createElement("p",null,"身份证号码：",n.state.id)),okText:"确定",okCallback:function(){return n.props.submit(n.state.name,n.state.id)},cancelText:"取消"})},n.handleIDInput=function(e){var t=e.target.value;n.setState({id:t}),t.length>=14&&(n.state.idValidator.isValid(t)?n.state.valid||n.setState({valid:!0}):n.state.valid&&n.setState({valid:!1}))},l=a,r(n,l)}return l(t,e),h(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.card,a=e.load;t?""!=t.data.card&&this.alert():a()}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=e.card,n=e.responseCode,o=this.refs.alert,r=this.props,l=r.path,i=r.reg,s=r.setReg,u=void 0;if(a&&""!=a.data.card&&this.state.init&&this.alert(),100===n&&this.state.init){this.props.authSuccess(this.state.name,this.state.id);var c=JSON.parse(sessionStorage.getItem("bao-user"));""!=l&&i?(u=l,s()):u="/user/setting",c.card=this.state.id,c.isAuth=2,sessionStorage.setItem("bao-user",(0,_["default"])(c)),this.refs.success.show({text:"认证成功",callback:function(){t.props.replace(u)}}),this.setState({init:!1})}301===n&&o.show({content:"该身份证已被认证，如有问题请联系客服！",okText:"确定"}),302===n&&o.show({title:"身份证认证失败",content:"请输入真实的身份证姓名和身份证号",okText:"确定"}),303===n&&o.show({content:"根据相关规定，投资者年龄必须在18~65之间",okText:"确定"})}},{key:"componentDidUpdate",value:function(){this.props.clearData()}},{key:"alert",value:function(){var e=this.refs.alert;e.show({content:"您已经认证过身份，无需认证",okText:"返回",okCallback:this.props.pop})}},{key:"loadDom",value:function(){return g["default"].createElement(G["default"],null)}},{key:"loadEnd",value:function(){var e=this,t=this.props.pending;return g["default"].createElement("div",null,g["default"].createElement("div",{className:O["default"].form},g["default"].createElement("div",{onClick:function(){return e.refs.name.focus()},className:O["default"].row},g["default"].createElement("span",null,"真实姓名"),g["default"].createElement("input",{ref:"name",type:"text",placeholder:"请输入身份证姓名",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),g["default"].createElement("div",{onClick:function(){return e.refs.id.focus()},className:O["default"].row},g["default"].createElement("span",null,"身份证号"),g["default"].createElement("input",{ref:"id",type:"tel",placeholder:"请输入18位身份证号",maxLength:18,value:this.state.id,onChange:this.handleIDInput}))),g["default"].createElement("div",{className:O["default"].buttonWrap},g["default"].createElement("button",{disabled:!(this.state.valid&&this.state.name),onClick:this.submit},t&&g["default"].createElement(y["default"],{color:"#fff"}),"实名认证")))}},{key:"render",value:function(){var e=this.props,t=e.pop,a=e.card,n=void 0;return a?""==a.data.card&&(n=this.loadEnd()):n=this.loadDom(),g["default"].createElement("div",{className:O["default"].root},g["default"].createElement(v["default"],{onLeft:t},"身份认证"),n,g["default"].createElement(w["default"],{ref:"confirm"}),g["default"].createElement(T["default"],{ref:"alert"}),g["default"].createElement(R["default"],{ref:"success"}))}}]),t}(g["default"].Component),L=function(e){return{card:e.infodata.getIn(["USER_INFO_WITH_LOGIN","data"]),responseCode:e.infodata.getIn([M.IDENTITY_AUTH,"data"])&&+e.infodata.getIn([M.IDENTITY_AUTH,"data"]).code||0,pending:e.infodata.getIn([M.IDENTITY_AUTH,"pending"]),path:e.infodata.getIn([M.REGISTER_NUM,"pathLeave"])&&e.infodata.getIn([M.REGISTER_NUM,"pathLeave"]).path||"",reg:e.infodata.getIn([M.REGISTER_NUM,"regSuccess"])&&e.infodata.getIn([M.REGISTER_NUM,"regSuccess"]).reg||""}},q=function(e){return{load:function(){e({type:"USER_INFO_WITH_LOGIN"})},pop:function(){e((0,C.go)(-1))},replace:function(t){e((0,C.replace)(t))},submit:function(t,a){e({type:M.IDENTITY_AUTH,params:[{name:t,code:a}]})},setReg:function(){e({type:"REGISTER_NUM",key:"regSuccess",data:{reg:!1}})},authSuccess:function(t,a){e({type:M.SET_USERNAME_SUCCESS,key:"USER_INFO_WITH_LOGIN",data:{name:t,card:a,isAuth:2}})},clearData:function(){e({type:"CLEAR_INFO_DATA",key:"IDENTITY_AUTH"})}}};t["default"]=(0,D.connect)(L,q)(H)},1608:function(e,t,a){t=e.exports=a(6)(),t.push([e.id,".root___1KfMI{height:100%;padding-top:44px;background-color:#f0eff5}.form___27E8l{background-color:#fff;height:89px;padding-left:15px;margin-top:15px;-webkit-box-orient:vertical;-o-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;border-top:1px solid #ddd;border-bottom:1px solid #ddd}.form___27E8l,.row___BOVSf{display:-webkit-box;display:-ms-flexbox;display:box;display:flex}.row___BOVSf{-webkit-box-flex:1;-o-box-flex:1;box-flex:1;-ms-flex:1;flex:1}.row___BOVSf:nth-child(1){border-bottom:1px solid #ddd}.row___BOVSf span{display:inline-block;height:100%;line-height:43px}.row___BOVSf input{border:0;margin-left:15px;-webkit-box-flex:1;-o-box-flex:1;box-flex:1;-ms-flex:1;flex:1}.buttonWrap___qcwSs{margin-top:20px}.buttonWrap___qcwSs,.buttonWrap___qcwSs button{display:-webkit-box;display:-ms-flexbox;display:box;display:flex}.buttonWrap___qcwSs button{-webkit-box-pack:center;-o-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-o-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-o-box-flex:1;box-flex:1;-ms-flex:1;flex:1;height:44px;margin:0 15px;border-radius:3px;background-color:#00a6e2;-webkit-transition:all .5s ease-in-out;transition:all .5s ease-in-out;font-size:16px;color:#fff;border:0}.buttonWrap___qcwSs button:disabled{background-color:#0095cb;color:#d9d9d9}.ensure___rmviJ p{text-align:left;margin-bottom:10px}.ensure___rmviJ p:not(:nth-child(1)){color:#999}",""]),t.locals={root:"root___1KfMI",form:"form___27E8l",row:"row___BOVSf",buttonWrap:"buttonWrap___qcwSs",ensure:"ensure___rmviJ"}},2206:function(e,t,a){var n=a(1608);"string"==typeof n&&(n=[[e.id,n,""]]);a(7)(n,{});n.locals&&(e.exports=n.locals)}});